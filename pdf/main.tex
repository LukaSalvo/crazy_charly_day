\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[french]{babel}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{margin=2.5cm}
\usepackage{graphicx} % Essentiel pour les images
\usepackage{hyperref}
\usepackage{enumitem}

\begin{document}

% --- PAGE DE GARDE AVEC LOGOS ---
\begin{titlepage}
    \centering
    % Insertion des deux logos en haut
    \begin{minipage}{0.45\textwidth}
        \begin{flushleft}
            \includegraphics[width=4cm]{img/logo_iut.png} % 
        \end{flushleft}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \begin{flushright}
            \includegraphics[width=4cm]{img/logo_toys_academi.png} % Remplacez par votre fichier
        \end{flushright}
    \end{minipage}
    
    \vspace{4cm}
    
    {\scshape\LARGE IUT - Crazy Crew \par}
    \vspace{1.5cm}
    {\scshape\LARGE Equipe mixte \par}
    \vspace{1.5cm}
    {\huge\bfseries Cahier des Charges : Projet ToyBoxing\par}
    \vspace{0.5cm}
    {\Large\itshape Crazy Charly Day 2026\par}
    
    \vspace{2cm}
    \textbf{Commanditaire :}\\
    Association Toys Academy \par
    \vspace{2cm}

    \vfill
    {\large Réalisé par :\\ \textbf{2 Crazy Crew}}
    
    \vfill
    {\large \today \par}
\end{titlepage}

\newpage
\tableofcontents
\newpage

\section{Présentation du projet}
Ce projet est réalisé pour l'association \textbf{Toys Academy} dans le cadre des \textbf{Crazy Charly Day 2026}. L'objectif est de concevoir une application Web permettant la gestion et l'optimisation de "Toy Boxes" : des boîtes de jouets reconditionnés envoyées aux abonnés selon leurs préférences et l'âge de l'enfant.

\section{Objectifs techniques}
Le développement s'articule autour de certains axes principaux:
\begin{itemize}
    \item Une application Web de gestion des articles et des abonnements.
    \item Une optimisation de la composition des box.
    \item Un déploiement de la solution globale sur un serveur public.
    \item Une collaboration inter-départements pour enrichir les fonctionnalités et l'expérience utilisateur.
    \item Une interface responsive pour les abonnés, accessible sur mobile.
\end{itemize}

\section{Spécifications Fonctionnelles}

\subsection{Base de données}
La base de données doit inclure les tables suivantes :
\begin{itemize}
    \item \textbf{Article} : id : UUID , désignation : string , id\_categ : entier , id\_age : entier , id\_etat : entier , prix : numeric(10,2) , poids : numeric(10,3).
    \item \textbf{Utilisateur} : id : UUID , nom : string , mail : string , mdp : string , admin : booléen.
    \item \textbf{Client} : id : UUID (FK utilisateur) , age : entier , categ\_1 à categ\_6 : entier (FK catégorie).
    \item \textbf{Catégorie} : id : entier , libellé : string.
    \item \textbf{Age} : id : entier , libellé : string.
    \item \textbf{Etat} : id : entier , libellé : string.
    \item \textbf{Box} : id : UUID , id\_client : UUID , prix : numeric(10,2) , poids : numeric(10,3) , score : entier.
    \item \textbf{Campagne} : id : UUID , poids\_max : numeric(10,3) , prix\_min : numeric(10,2) , prix\_max : numeric(10,2).
    \item \textbf{Boxobj} : id\_box : UUID , id\_article : UUID.
    \item \textbf{Boxcampagne} : id\_box : UUID , id\_campagne : UUID.
\end{itemize}
Voici un schéma de la base de données :
\begin{center}
    \includegraphics[width=0.8\textwidth]{img/Capture d’écran 2026-02-19 à 14.32.31.png}
\end{center}


\subsection{Conteneurisation}
L'application doit être conteneurisée à l'aide de Docker, avec les services suivants :
\begin{itemize}
    \item \textbf{Backend} : Un conteneur basé sur PHP 8.2+ hébergeant l'API REST.
    \item \textbf{Frontend} : Un conteneur Node.js pour le développement (Vite) et un serveur Nginx pour la production.
    \item \textbf{Base de données} : Un conteneur PostgreSQL 15+ pour la persistance des données.
    \item \textbf{Orchestration} : Utilisation de \texttt{docker-compose} pour lier les services, gérer les volumes de données et les réseaux internes.
\end{itemize}



\section{Architecture Logicielle}
L'arborescence du projet témoigne d'une volonté de séparation stricte des responsabilités.

\subsection{Backend (PHP)}
Le backend suit une \textbf{architecture hexagonale} rigoureuse, utilisant le framework Slim 4 et l'injection de dépendances (PHP-DI) :
\begin{itemize}
    \item \textbf{Application Core} : La logique métier est isolée dans le namespace \texttt{application\_core}. Elle définit les ports (DTOs comme \texttt{AbonneDTO}, \texttt{ArticleDTO}) et les services métiers (\texttt{Service.php}).
    \item \textbf{Infrastructure} : Implémentation de la persistance via le \textit{Pattern Repository} (\texttt{UserRepository.php}, \texttt{Repository.php}) assurant l'indépendance vis-à-vis du SGBD PostgreSQL.
    \item \textbf{Couche API} : 
        \begin{itemize}
            \item \textbf{Actions} : Chaque point de terminaison est géré par une classe unique (ex: \texttt{AjouterArticleAction}, \texttt{RegisterAction}).
            \item \textbf{Middleware Stack} : Sécurisation par couches incluant la gestion du \texttt{CORS}, l'authentification JWT (\texttt{AuthnMiddleware}), et les autorisations (\texttt{AuthzMiddleware}).
        \end{itemize}
\end{itemize}

\subsection{Frontend (Vue.js 3)}
L'interface est une \textit{Single Page Application} (SPA) développée avec \textbf{Vue.js 3} et l'outil de build \textbf{Vite}. Elle est structurée en deux espaces distincts :
\begin{itemize}
    \item \textbf{Espace Client (Front Office)} : Gestion du tunnel d'achat et des préférences (\texttt{RegisterView}, \texttt{LoginView}, \texttt{BoxView}).
    \item \textbf{Espace Gestionnaire (Back Office)} : Tableaux de bord pour le suivi des campagnes et des abonnés (\texttt{DashboardView}, \texttt{CampaignView}, \texttt{SubscribersView}).
    \item \textbf{Navigation} : Utilisation de \texttt{vue-router} pour assurer un routage fluide sans rechargement de page.
\end{itemize}



\section{Pipeline de Déploiement (CI/CD)}
Afin de garantir la qualité et la stabilité du code à chaque modification :
\begin{itemize}
    \item \textbf{Intégration Continue} : Utilisation de GitHub Actions pour automatiser les tests en déploiyant les docker pour vérifier si ils se lancent correctement.
    \item \textbf{Validation Docker} : À chaque \textit{push} sur la branche principale, une pipeline vérifie que les conteneurs se construisent (\texttt{build}) et démarrent (\texttt{up}) correctement.
    \item \textbf{Sécurité} : Gestion des variables d'environnement sensibles via les \textit{Secrets} GitHub pour éviter toute fuite de données de connexion.
\end{itemize}



\section{Déploiement}
\subsection{Choix de l'infrastructure}
Initialement prévu sur l'infrastructure \texttt{Dockétu}, le déploiement a été migré vers un serveur privé accessible publiquement. Ce choix stratégique a permis de lever plusieurs barrières techniques rencontrées en environnement partagé :
\begin{itemize}
    \item \textbf{Gestion des ports} : Éviter les conflits de ports dynamiques rencontrés sur Dockétu, permettant d'utiliser les ports standards pour l'API et le Frontend.
    \item \textbf{Configuration Réseau} : Résolution des blocages liés aux hôtes autorisés (\textit{Allowed Hosts}) de Vite.js et aux politiques de sécurité CORS.
    \item \textbf{Disponibilité} : Accès permanent via une adresse publique stable pour les démonstrations et tests utilisateurs.
\end{itemize}



\end{document}